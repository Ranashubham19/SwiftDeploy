# Railway configuration file

[build]
builder = "DOCKERFILE"
dockerfilePath = "Dockerfile"

[variables]
TELEGRAM_BOT_TOKEN = { required = true, description = "Telegram Bot Token from @BotFather" }
OPENROUTER_API_KEY = { required = true, description = "OpenRouter API key" }
DATABASE_URL = { required = true, description = "PostgreSQL connection string" }
APP_URL = { required = false, description = "Public Railway URL used for Telegram webhook" }
OPENROUTER_BASE_URL = { required = false, description = "OpenRouter base URL (default: https://openrouter.ai/api/v1)" }
DEFAULT_MODEL = { required = false, description = "Default model key/id (default: openrouter/auto)" }
FALLBACK_MODEL = { required = false, description = "Fallback model id" }
MAX_INPUT_CHARS = { required = false, description = "Max Telegram input chars per message" }
MAX_OUTPUT_TOKENS = { required = false, description = "Max OpenRouter output tokens" }
STREAM_EDIT_INTERVAL_MS = { required = false, description = "Streaming edit throttle interval for Telegram message edits" }
MODEL_FAST_ID = { required = false, description = "Override fast model id" }
MODEL_SMART_ID = { required = false, description = "Override smart model id" }
MODEL_CODE_ID = { required = false, description = "Override code model id" }
MODEL_MATH_ID = { required = false, description = "Override math model id" }
MODEL_VISION_ID = { required = false, description = "Override vision model id" }
SUMMARY_MODEL = { required = false, description = "Model id used for running summary updates" }
LOG_LEVEL = { required = false, description = "pino log level (info/debug/warn/error)" }

[deploy]
startCommand = "npm --prefix backend run start:railway"
healthcheckPath = "/health"
healthcheckTimeout = 300
numReplicas = 1
region = "us-east1"
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 3
